- # encoding: utf-8
!!! 5
%html
  %head
    %meta{charset: "utf-8"}
    %title 1C Integration Success Report
    %style{type: "text/css"}
      :css
        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          line-height: 1.6;
          color: #333;
          max-width: 800px;
          margin: 0 auto;
          padding: 20px;
          background-color: #f5f5f5;
        }
        .container {
          background-color: white;
          border-radius: 8px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          padding: 30px;
        }
        .header {
          background: linear-gradient(135deg, #28a745, #20c997);
          color: white;
          padding: 20px;
          border-radius: 6px 6px 0 0;
          margin: -30px -30px 20px -30px;
        }
        .header h1 {
          margin: 0;
          font-size: 24px;
          text-align: center;
        }
        .success {
          background-color: #d4edda;
          border: 1px solid #c3e6cb;
          border-radius: 4px;
          padding: 15px;
          margin: 15px 0;
          text-align: center;
        }
        .info-section {
          margin: 20px 0;
          padding: 15px;
          background-color: #f8f9fa;
          border-left: 4px solid #28a745;
          border-radius: 0 4px 4px 0;
        }
        .info-section h3 {
          margin-top: 0;
          color: #28a745;
        }
        .stats {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 15px;
          margin: 15px 0;
        }
        .stat-item {
          background-color: #f8f9fa;
          padding: 15px;
          border-radius: 4px;
          text-align: center;
          border: 1px solid #dee2e6;
        }
        .stat-value {
          font-size: 24px;
          font-weight: bold;
          color: #28a745;
          display: block;
        }
        .stat-label {
          font-size: 12px;
          color: #6c757d;
          margin-top: 5px;
        }
        .metadata {
          font-size: 12px;
          color: #666;
          border-top: 1px solid #eee;
          margin-top: 30px;
          padding-top: 15px;
        }
  %body
    .container
      .header
        %h1 ‚úÖ –£–°–ü–ï–®–ù–ê–Ø –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –° 1C
        
      .success
        üéâ –ü—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π 1C –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ!
        %br
        –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
        
      .info-section
        %h3 üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—Ä–æ—Å–µ
        %p
          %strong ID –∑–∞–ø—Ä–æ—Å–∞:
          = request_id
        %p
          %strong –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
          = timestamp
        %p
          %strong –°–µ—Ä–≤–µ—Ä:
          = server_info[:host]
        %p
          %strong –û–∫—Ä—É–∂–µ–Ω–∏–µ:
          = server_info[:environment].upcase
          
      .info-section
        %h3 üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
        .stats
          .stat-item
            %span.stat-value= statistics[:total_duration] || 'N/A'
            %div.stat-label –û–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å–µ–∫)
          .stat-item
            %span.stat-value= statistics[:processed_items] || '0'
            %div.stat-label –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤
          .stat-item
            %span.stat-value= statistics[:http_requests] || '0'
            %div.stat-label HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ 1C
          .stat-item
            %span.stat-value= statistics[:batches_processed] || '0'
            %div.stat-label –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –±–∞—Ç—á–µ–π
          .stat-item
            %span.stat-value= statistics[:updated_products] || '0'
            %div.stat-label –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤
          .stat-item
            %span.stat-value= statistics[:data_transfer_mb] || 'N/A'
            %div.stat-label –ü–µ—Ä–µ–¥–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö (–ú–ë)
            
      - if statistics[:performance_metrics]
        .info-section
          %h3 ‚ö° –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
          %p
            %strong –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏:
            = statistics[:performance_metrics][:items_per_second] || 'N/A'
            —Ç–æ–≤–∞—Ä–æ–≤/—Å–µ–∫
          %p
            %strong –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è HTTP –∑–∞–ø—Ä–æ—Å–∞:
            = statistics[:performance_metrics][:avg_http_time] || 'N/A'
            –º—Å
          %p
            %strong –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:
            = statistics[:performance_metrics][:cpu_usage] || 'N/A'
          %p
            %strong –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:
            = statistics[:performance_metrics][:memory_usage] || 'N/A'
            
      - if statistics[:warnings] && !statistics[:warnings].empty?
        .info-section
          %h3 ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
          %ul
            - statistics[:warnings].each do |warning|
              %li= warning
              
      .info-section
        %h3 ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        %p ‚úì –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
        %p ‚úì –¶–µ–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å 1C
        %p ‚úì –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–ª–∏—á–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
        %p ‚úì –ö–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        %p ‚úì –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ
        
      .metadata
        %p
          %strong –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
          RozarioFlowers 1C Integration Monitor
        %p
          %strong –í–µ—Ä—Å–∏—è Ruby:
          = server_info[:ruby_version]
        %p
          %strong –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞:
          = Time.now.strftime('%d.%m.%Y %H:%M:%S %Z')
        %p
          %em –≠—Ç–æ—Ç –æ—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –ù–µ –æ—Ç–≤–µ—á–∞–π—Ç–µ –Ω–∞ —ç—Ç–æ –ø–∏—Å—å–º–æ.
