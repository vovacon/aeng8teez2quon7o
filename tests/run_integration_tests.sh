#!/bin/bash
# encoding: utf-8

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

echo "üîó –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤..."
echo "==============================================="
echo "‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç:"
echo "  - MySQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö admin_rozario"
echo "  - –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã: comments, orders, smiles"
echo "  - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã (DB_HOST, DB_USER, DB_PASSWORD)"
echo ""

# –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–µ–¥—ã
echo "‚Üí –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."
if ruby integration/test_basic_models.rb; then
  echo "‚úÖ –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω - –æ–∫—Ä—É–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ"
  echo ""
else
  echo "‚ùå –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ"
  echo ""
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (–≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–µ)
for test_file in integration/test*.rb; do
  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç (–æ–Ω —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω)
  if [[ "$test_file" == "integration/test_basic_models.rb" ]]; then
    continue
  fi
  
  if [ -f "$test_file" ]; then
    echo "‚Üí –ó–∞–ø—É—Å–∫ $test_file"
    if ruby "$test_file" 2>&1; then
      echo "‚úÖ $test_file –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ"
    else
      echo "‚ùå –û—à–∏–±–∫–∞ –≤ $test_file"
    fi
    echo ""
  fi
done

echo "‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã"
